{
  "hash": "1844c5ce389cb481d8e6fea5b01ef65c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"testracefilter\"\noutput: html_document\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(waffle)\n\narticles <- read_csv('../data/article_dat.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 318 Columns: 65\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (26): doi, jabbrv, journal, month, day, title, abstract, keywords, study...\ndbl (35): pmid, year, study_year_start, study_year_end, race1_ss, race2_ss, ...\nlgl  (4): eth7, eth7_ss, eth8, eth8_ss\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nwhite <- c(\n  \"WHITE\" = \"White\",\n  \"HISPANIC WHITE\" = \"White\",\n  \"EUROPEAN AMERICAN\" = \"White\",\n  \"CAUCASIAN OR WHITE\" = \"White\",\n  \"WHITE, NON-HISPANIC\" = \"White\",\n  \"CAUCASIAN\" = \"White\",\n  \"NON-HISPANIC WHITE\" = \"White\",\n  \"NH WHITE\" = \"White\",\n  \"NON-HISPANIC WHITE AND ADDITIONAL RACE AND ETHNICITIES\" = \"White\",\n  \"WHITE/CAUCASIAN\"=\"White\",\n  \"NON HISPANIC WHITES\"=\"White\",\n  \"CAUCASIANS\"=\"White\",\n  \"WHITE - NOT HISPANIC OR LATINO\",\n  \"WHITE (NON-HISPANIC)\"=\"White\",\n  \"WHITE NON-HISPANIC\"=\"White\",\n  \"WHITE DONOR / WHITE RECIPIENT\"=\"White\",\n  \"U.S.-BORN, NON-HISPANIC WHITE;\"=\"White\",\n  \"NON-HISPANIC, WHITE\"=\"White\",\n  \"WHITE (OR CAUCASIAN)\"=\"White\",\n  \"WHITES\"=\"White\",\n  \"WHITE-NON-HISPANIC\"=\"White\",\n  \"NON-LATINA WHITE\"=\"White\",\n  \"WHITE OR CAUCASIAN\"=\"White\",\n  \"WHITE - NOT HISPANIC OR LATINO\"=\"White\",\n  \"NON HISPANIC WHITE\"=\"White\"\n\n)\n\nblack <- c(\n  \"BLACK\" = \"Black or African American\",\n  \"NON-HISPANIC BLACK\" = \"Black or African American\",\n  \"AFRICAN AMERICAN\" = \"Black or African American\",\n  \"BLACK/AFRICAN AMERICAN\" = \"Black or African American\",\n  \"BLACK, NON-HISPANIC\" = \"Black or African American\",\n  \"BLACK NON-HISPANIC\" = \"Black or African American\",\n  \"BLACK OR AFRICAN AMERICAN\" = \"Black or African American\",\n  \"AFRICAN AMERICANS\" = \"Black or African American\",\n  \"AFRICAN-AMERICAN\" = \"Black or African American\",\n  \"AFRICAN AMERICAN/BLACK\" = \"Black or African American\",\n  \"U.S.-BORN, NON-HISPANIC BLACK\" = \"Black or African American\",\n  \"NON-HISPANIC, BLACK\" = \"Black or African American\",\n  \"BLACKS\" = \"Black or African American\",\n  \"BLACK (NON-HISPANIC)\" = \"Black or African American\",\n  \"NONBLACK\" = \"Black or African American\",\n  \"AFRICAN AMERICAN OR BLACK\" = \"Black or African American\",\n  \"BLACK DONOR / BLACK RECIPIENT\" = \"Black or African American\",\n  \"BLACK DONOR / NONBLACK RECIPIENT\" = \"Black or African American\",\n  \"AFRICAN AMERICAN, NON-HISPANIC\" = \"Black or African American\",\n  \"AFRICAN-AMERICAN, NON-HISPANIC\" = \"Black or African American\",\n  \"NON-HISPANIC BLACK/AFRICAN AMERICAN\" = \"Black or African American\"\n)\n\nhispanic <- c(\n  \"HISPANIC\" = \"Hispanic or Latino\",\n  \"HISPANIC WHITES\" = \"Hispanic or Latino\",\n  \"HISPANIC/LATINA\" = \"Hispanic or Latino\",\n  \"LATINA/HISPANIC\" = \"Hispanic or Latino\",\n  \"US-BORN HISPANIC\" = \"Hispanic or Latino\",\n  \"OTHER HISPANIC\" = \"Hispanic or Latino\",\n  \"LATINA\" = \"Hispanic or Latino\",\n  \"HISPANIC OR LATINO\"=\"Hispanic or Latino\",\n  \"LATINO\"=\"Hispanic or Latino\",\n  \"LATINO AMERICAN\"=\"Hispanic or Latino\",\n  \"HISPANIC OR LATINA\"=\"Hispanic or Latino\",\n  \"HISPANIC OR LATINO\"=\"Hispanic or Latino\",\n  \"HISPANIC (OF ANY RACE)\"=\"Hispanic or Latino\",\n  \"HISPANIC, SPANISH-SPEAKING\"=\"Hispanic or Latino\",\n  \"LATINA WHITE\"=\"Hispanic or Latino\",\n  \"FOREIGN-BORN HISPANIC\"=\"Hispanic or Latino\",\n  \"HISPANIC, NOT OTHERWISE SPECIFIED\"=\"Hispanic or Latino\",\n  \"HISPANIC DONOR / HISPANIC RECIPIENT\"=\"Hispanic or Latino\",\n  \"HISPANIC/LATINX\"=\"Hispanic or Latino\",\n  \"HISPANIC/LATINO/A\"=\"Hispanic or Latino\",\n  \"HISPANIC DONOR / NON-HISPANIC RECIPIENT\"=\"Hispanic or Latino\",\n  \"HISPANIC, ENGLISH-SPEAKING\"=\"Hispanic or Latino\",\n  \"HISPANIC AMERICAN\"=\"Hispanic or Latino\",\n  \"HISPANIC, LATINA\"=\"Hispanic or Latino\",\n  \"HISPANIC, ENGLISH-SPEAKING\"=\"Hispanic or Latino\",\n  \"HISPANIC OR LATINX\"=\"Hispanic or Latino\",\n  \"LATINA (SPANISH SPEAKING)\"=\"Hispanic or Latino\",\n  \"LATINA (ENGLISH-SPEAKING)\"=\"Hispanic or Latino\",\n  \"HISPANIC/LATINO\"=\"Hispanic or Latino\"\n)\n\nasian <- c(\n  \"ASIAN\" = \"Asian\",\n  \"ASIAN AMERICAN\" = \"Asian\",\n  \"NON-HISPANIC ASIAN\" = \"Asian\",\n  \"ASIAN/PACIFIC ISLANDER\" = \"Asian\",\n  \"ASIAN OR PACIFIC ISLANDER\" = \"Asian\",\n  \"ASIAN/PACIFIC\" = \"Asian\",\n  \"NON-HISPANIC ASIAN OR PACIFIC ISLANDER\" = \"Asian\",\n  \"CHINESE\"=\"Asian\",\n\"NON-HISPANIC, ASIAN\" = \"Asian\",\n\"ASIAN DONOR / NON-ASIAN RECIPIENT\" = \"Asian\",\n\"ASIAN DONOR / ASIAN RECIPIENT\" = \"Asian\",\n\"SOUTH ASIAN\" = \"Asian\",\n\"ASIAN AND OTHER\" = \"Asian\",\n\"ASIAN OR ASIAN AMERICAN\" = \"Asian\",\n\"ASIAN/NHOPI\" = \"Asian\",\n\"ASIAN, NON-HISPANIC\" = \"Asian\",\n\"ASIAN AMERICAN AND PACIFIC ISLANDER\" = \"Asian\",\n\"ASIAN/ASIAN AMERICAN\" = \"Asian\"\n\n)\n\naian <- c(\n\"AMERICAN INDIAN/ALASKA NATIVE\" = \"American Indian or Alaska Native\",\n\"NON-HISPANIC AMERICAN INDIAN/ALASKA NATIVE\" = \"American Indian or Alaska Native\",\n\"NON-HISPANIC NATIVE AMERICAN\" = \"American Indian or Alaska Native\",\n\"AMERICAN INDIAN/ALASKA NATIVE\" = \"American Indian or Alaska Native\",\n\"AMERICAN INDIAN/ALASKAN\" = \"American Indian or Alaska Native\",\n  \"AMERICAN INDIAN, ALASKA NATIVE, AND NATIVE HAWAIIAN\" = \"American Indian or Alaska Native\",\n  \"AMERICAN INDIAN OR ALASKA NATIVE\" = \"American Indian or Alaska Native\",\n  \"AMERICAN INDIAN OR ALASKA NATIVE, NON-HISPANIC\" = \"American Indian or Alaska Native\",\n  \"NATIVE AMERICAN\" = \"American Indian or Alaska Native\",\n  \"NON-HISPANIC AMERICAN INDIAN\" = \"American Indian or Alaska Native\",\n  \"INDIGENOUS AMERICAN\" = \"American Indian or Alaska Native\",\n  \"AMERICAN INDIAN/ALASKAN NATIVE\"=\"American Indian or Alaska Native\",\n  \"AMERICAN INDIAN/ALASKA NATIVE\"=\"American Indian or Alaska Native\",\n\"INDIAN AMERICAN\"=\"American Indian or Alaska Native\",\n\"NATIVE AMERICAN OR ALASKAN NATIVE\"=\"American Indian or Alaska Native\"\n)\n\nother_unk <- c(\n  \"AMERICAN INDIAN\"= \"Other\",\n  \"ALASKAN NATIVE\"= \"Other\",\n  \"NON-HISPANIC AMERICAN INDIAN OR ALASKA NATIVE\" = \"Other\",\n  \"AMERICAN INDIAN OR ALASKAN\" = \"Other\",\n  \"INDIGENOUS\" = \"Other\",\n  \"OTHER\" = \"Other\",\n  \"OTHER RACE\" = \"Other\",\n  \"OTHERS\"=\"Other\",\n  \"OTHER/UNKNOWN\"=\"Other\",\n  \"WHITE DONOR / NONWHITE RECIPIENT\" = \"Other\",\n  \"NON WHITE\" = \"Other\",\n  \"NON WHITE RACE\" = \"Other\",\n  \"NON-WHITE\" = \"Other\",\n  \"NON-BLACK\" = \"Other\",\n  \"HBNO (HISPANIC, BLACK, NATIVE AMERICAN/ALASKAN AND OTHER)\" = \"Other\",\n  \"NON-HISPANIC OTHER\" = \"Other\",\n  \"NON-HISPANIC OTHER RACE\" = \"Other\",\n  \"NON-HISPANIC, ALL OTHERS\" = \"Other\",\n  \"OTHER OR MULTIPLE RACES, NON-HISPANIC\" = \"Other\",\n  \"HISPANIC ETHNICITY\" = \"Other\",\n  \"MULTIRACIAL\" = \"Other\",\n  \"ADDITIONAL RACES AND ETHNICITIES OR MIXED\" = \"Other\",\n  \"MULTIPLE OR OTHER\" = \"Other\",\n  \"TWO OR MORE RACES\" = \"Other\",\n  \"NON-HISPANIC OTHER-MULTI-RACE\" = \"Other\",\n  \"OTHER OR MISSING\" = \"Other\",\n  \"OTHER, MIXED, UNKNOWN\" = \"Other\",\n  \"SOMALIA-BORN\" = \"Other\",\n  \"AFRICAN-BORN BLACK\" = \"Other\",\n  \"OTHER MINORITY\" = \"Other\",\n  \"OTHER/MULTIRACIAL\" = \"Other\",\n  \"MEXICAN/AMERICAN\" = \"Other\",\n  \"OTHER RACES OR ETHNICITY\" = \"Other\",\n  \"MULTIRACIAL OR OTHER\" = \"Other\",\n  \"OTHER RACE-ETHNICITY\" = \"Other\",\n\n  \"UNKNOWN\"=\"Unknown\",\n  \"NOT IDENTIFIED\"=\"Unknown\",\n  \"OTHER OR UNKNOWN\"=\"Unknown\",\n  \"OTHER OR ASIAN\"=\"Unknown\",\n  \"MULTIRACIAL\"=\"Unknown\",\n  \"MISSING\"=\"Unknown\",\n  \"OTHER/UNKNOWN\"=\"Unknown\",\n  \"MORE THAN ONE RACE\"=\"Unknown\",\n\"MULTIPLE RACES\"=\"Unknown\",\n\"NOT IDENTIFIED\"=\"Unknown\",\n\"UNKNOWN OR MISSING\"=\"Unknown\",\n\"NONE OF THE ABOVE\"=\"Unknown\",\n\"UNABLE TO DETERMINE\"=\"Unknown\",\n\"DECLINED OR UNKNOWN\"=\"Unknown\",\n\"NATIVE AMERICAN OR UNKNOWN\"=\"Unknown\",\n\"UNKNOWN/OTHER\"=\"Unknown\",\n\"OTHER/NOS/UNKNOWN\"=\"Unknown\",\n  \"OTHER/MISSING\"=\"Unknown\",\n\"ALL OTHER/UNKNOWN OR MISSING\"=\"Unknown\",\n\"RECIPIENTS MISSING RACE/ETHNICITY\"=\"Unknown\",\n\"UNAVAILABLE\"=\"Unknown\",\n\"OTHERS OR UNKNOWN\"=\"Unknown\",\n\"NONE OF THE ABOVE, MULTIPLE, OR UNKNOWN\"=\"Unknown\",\n\"DECLINED OR UNAVAILABLE\"=\"Unknown\",\n\"NONE OF THE ABOVE, NON-HISPANIC\"=\"Unknown\",\n\"UNKNOWN/NOT DOCUMENTED\"=\"Unknown\",\n\"ITEM MISSED OR SKIPPED\"=\"Unknown\",\n\"OTHER, MIXED, OR UNKNOWN\"=\"Unknown\"\n)\n\nnhpi <- c(\n  \"HAWAIIAN\"=\"Native Hawaiian Or Pacific Islander\",\n\"PACIFIC ISLANDER/HAWAIIAN\"=\"Native Hawaiian Or Pacific Islander\",\n\"NATIVE HAWAIIAN\"=\"Native Hawaiian Or Pacific Islander\",\n\"PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\"NON-HISPANIC ASIAN/PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\"NONHISPANIC ASIAN OR PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\"NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\"NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER, NON-HISPANIC\"=\"Native Hawaiian Or Pacific Islander\",\n\"HAWAIIAN/PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\"NON-HISPANIC ASIAN AND PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\"NATIVE HAWAIIAN OR PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\"NATIVE HAWAIIAN/PACIFIC ISLANDER\"=\"Native Hawaiian Or Pacific Islander\",\n\n\"URM (BLACK, HISPANIC, NATIVE AMERICAN/ALASKAN, ASIAN/PACIFIC ISLANDER, AND OTHER)\"=\"Uncategorized\",\n\"WHITE/OTHER\"=\"Uncategorized\",\n\"SOUTH AND CENTRAL AMERICAN\"=\"Uncategorized\",\n\"PUERTO RICAN\"=\"Uncategorized\",\n\"MEXICAN\"=\"Uncategorized\",\n\"CUBAN\"=\"Uncategorized\",\n\"NONWHITE\"=\"Uncategorized\",\n\"NH OTHER\"=\"Uncategorized\",\n\"NON-HISPANIC, NONE OF THE ABOVE\"=\"Uncategorized\",\n\"NON-HISPANIC MIXED\"=\"Uncategorized\",\n\"AMERICAN INDIAN, ALASKA NATIVE, OR OTHER\"=\"Uncategorized\",\n\"ASIAN, NATIVE HAWAIIAN, OR PACIFIC ISLANDER\"=\"Uncategorized\",\n\"NATIVE\"=\"Uncategorized\",\n\"NH BLACK\"=\"Uncategorized\",\n\"OTHER (ASIAN, PACIFIC ISLANDER, NATIVE AMERICAN, MIXED OR OTHER)\"=\"Uncategorized\",\n\"NON AFRICAN AMERICAN\"=\"Uncategorized\",\n\"NON-AFRICAN AMERICAN\"=\"Uncategorized\",\n\"EUROPEAN AMERICANS\"=\"Uncategorized\",\n\"MINORITY\"=\"Uncategorized\"\n)\n\n\nrace_mapping <- c(\n  white,\n  black,\n  hispanic,\n  asian,\n  aian,\n  other_unk,\n  nhpi\n)\nrace_columns <- c(\"race1\", \"race2\", \"race3\", \"race4\", \"race5\", \"race6\", \"race7\", \"race8\")\n\n# articles <- articles |>\n#   mutate(clean_race = race_mapping[as.character(original_race_column)])\n\nunique_race_values <- articles |>\n  pivot_longer(cols = all_of(race_columns), names_to=\"race_column\", values_to = \"race_cleansed\") |>\n  mutate(race_cleansed=toupper(race_cleansed))\n\nurvs <- unique_race_values[[\"race_cleansed\"]]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nunique_race_values <- unique_race_values |>\n   mutate(clean_race = race_mapping[as.character(race_cleansed)])\n\n\nmissing <- unique_race_values[!is.na(unique_race_values$race_cleansed) & is.na(unique_race_values$clean_race),] |> select(race_cleansed)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nendingcleansed <- unique_race_values |> \n  rowwise() |>\n    mutate(race_value = cur_data()[[paste0(race_column, \"_ss\")]]) \n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `race_value = cur_data()[[paste0(race_column, \"_ss\")]]`.\nℹ In row 1.\nCaused by warning:\n! `cur_data()` was deprecated in dplyr 1.1.0.\nℹ Please use `pick()` instead.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- endingcleansed |> select(clean_race, race_value, journal, year) |> \n  filter(!is.na(clean_race) | !is.na(race_value))\n\n\naggregated_values <- data |> group_by(year, clean_race) |> summarise(\n  total_counts = sum(race_value)\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\n# we find that some values = -99, initial journal incorrect inputs\n\naggregated_values <- aggregated_values |> ungroup() |> filter(total_counts != -99)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(aggregated_values, aes(x=year, y=total_counts, color=clean_race)) +\n         geom_line()\n```\n\n::: {.cell-output-display}\n![](testracefilter_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nproportions <- aggregated_values |> \n  group_by(year, clean_race) |> \n  summarise(n = sum(total_counts)) |>\n  mutate(freq = (n / sum(n)) * 100)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nproportions <- proportions |> filter(round(freq, 0) > 0)\nggplot(proportions, aes(x=year, y=freq, fill=clean_race)) +\n         geom_col() + geom_text(aes(label=round(freq, 0)))\n```\n\n::: {.cell-output-display}\n![](testracefilter_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# set width of code output\noptions(width = 65)\nlibrary(ggplot2)\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'scales'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:purrr':\n\n    discard\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following object is masked from 'package:readr':\n\n    col_factor\n```\n\n\n:::\n\n```{.r .cell-code}\n# set figure parameters for knitr\nknitr::opts_chunk$set(\n  fig.width = 7,        # 7\" width\n  fig.asp = 0.618,      # the golden ratio\n  fig.retina = 3,       # dpi multiplier for displaying HTML output on retina\n  fig.align = \"center\", # center align figures\n  dpi = 300             # higher dpi, sharper image\n)\n\nggplot(proportions, aes(x=year, y=freq, color=clean_race)) +\n         geom_path(linewidth=1) + \n  labs(\n    x=\"Year\", y=\"Percentage of Total Population\"\n  ) \n```\n\n::: {.cell-output-display}\n![](testracefilter_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(proportions, aes(x=year, y=freq, color=clean_race)) +\n         geom_path(linewidth=1) + \n  facet_wrap(vars(clean_race))\n```\n\n::: {.cell-output-display}\n![](testracefilter_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=2100}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntmp <- proportions %>%\n  mutate(race2=clean_race)\n\ntmp %>%\n  ggplot( aes(x=year, y=freq)) +\n    geom_line( data=tmp %>% select(-clean_race), aes(group=race2), color=\"lightgrey\", size=0.5, alpha=0.5) +\n    geom_line( aes(color=clean_race), color=\"darkolivegreen4\", size=1.2 )+\n    theme(\n      legend.position=\"none\",\n      plot.title = element_text(size=14),\n      panel.grid = element_blank()\n    ) +\n    facet_wrap(~clean_race) + \n  theme(\n    panel.background=element_blank(),\n    strip.background=element_rect(fill=\"snow2\", color=\"snow3\"),\n    strip.clip=\"on\"\n  ) + \n  labs(\n    title = \"Comparison of proportional race disparities \\nin gynecological studies, 2010-2023\",\n    y=\"Percentage\", x=\"Year\"\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2\n3.4.0.\nℹ Please use `linewidth` instead.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](testracefilter_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=2100}\n:::\n\n```{.r .cell-code}\n# ref https://www.data-to-viz.com/caveat/spaghetti.html\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# comparison of study length \n\narticle_lengths <- articles[c('study_year_start', 'study_year_end', 'journal')] |> \n  mutate(research_length = study_year_end - study_year_start) |>\n  filter(!is.na(study_year_start) &\n           study_year_start > 0 & study_year_end > 0 )\n\narticle_lengths_aggregated <- article_lengths |> \n  group_by(journal, study_year_start) |> summarise(\n  mean = mean(research_length, rm.na=TRUE)\n) |> filter(!is.na(study_year_start) & mean != 99 & abs(study_year_start) != 99 & \n              mean > 0)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'journal'. You can override\nusing the `.groups` argument.\n```\n\n\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(article_lengths, aes(x=study_year_start, y=research_length, )) + \n  stat_density_2d(color=\"royalblue4\") + \n  xlim(1990, 2026) + \n  ylim(-10, 20) + \n  facet_wrap(~journal, scales=\"free_x\") + \n  labs(x=\"Starting Study Year\", y=\"Research Length\",\n       title=\"Comparison of study lengths across gynecological journals\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 18 rows containing non-finite outside the scale range\n(`stat_density2d()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](testracefilter_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=3000}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ggtext)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\np = ggplot(proportions, aes(fill = clean_race, values = freq)) +\n  geom_waffle(color = \"white\", size = .25, n_rows = 10, flip = TRUE) +\n  facet_wrap(~year, nrow = 1, strip.position = \"bottom\", scales=\"free_x\") +\n  scale_x_discrete() + \n  scale_y_continuous(labels = function(x) x * 10, # make this multiplyer the same as n_rows\n                     expand = c(0,0))+\n  labs(title = \"Comparison of Race and Ethnicity over time\\nin gynecological journals\",\n       caption = \"Source: TidyTuesday\")+\n  theme_minimal() + \n  theme(strip.placement = \"outside\",\n       panel.spacing.x = unit(.1, \"lines\"),\n       ) + \n  guides(\n    fill=guide_legend(title=\"Race/Ethnic Category\")\n  )\np\n```\n\n::: {.cell-output-display}\n![](testracefilter_files/figure-html/unnamed-chunk-16-1.png){fig-align='center' width=2100}\n:::\n:::\n",
    "supporting": [
      "testracefilter_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}